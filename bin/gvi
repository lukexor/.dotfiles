#! /usr/bin/env perl

use strict;
use warnings;

my $pattern = shift;

# Smartcase - If uppercase, case sensitive, otherwise case insensitve
my $prefix = $pattern =~ /[[:upper:]]/ ? '\C' : '\c';

# Escape slashes
$pattern =~ s{/}{\\/}gxms;

# If no args, use current directory and below
my $args = @ARGV ? join ' ', map { -d $_ ? "$_/*" : $_ } @ARGV : '**';

# Invoke vim
my $VIM = `which vim`;
chomp $VIM;
my $cmd = "$VIM +'vimgrep /$prefix$pattern/ $args' +'/$prefix$pattern/'";
print $cmd . "\n";
system($cmd);
